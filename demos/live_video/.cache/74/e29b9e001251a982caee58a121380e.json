{"id":"IEXf","dependencies":[{"name":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\calculators\\decode_multiple_poses.js.map","includedInParent":true,"mtime":1636880757153},{"name":"C:\\xampp\\htdocs\\pose-detection\\src\\posenet\\calculators\\decode_multiple_poses.ts","includedInParent":true,"mtime":1634828555464},{"name":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\package.json","includedInParent":true,"mtime":1636888836670},{"name":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\.babelrc","includedInParent":true,"mtime":1634828519177},{"name":"../constants","loc":{"line":54,"column":26},"parent":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\calculators\\decode_multiple_poses.js","resolved":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\constants.js"},{"name":"./build_part_with_score_queue","loc":{"line":55,"column":44},"parent":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\calculators\\decode_multiple_poses.js","resolved":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\calculators\\build_part_with_score_queue.js"},{"name":"./decode_multiple_poses_util","loc":{"line":56,"column":43},"parent":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\calculators\\decode_multiple_poses.js","resolved":"C:\\xampp\\htdocs\\pose-detection\\demos\\live_video\\node_modules\\@tensorflow-models\\pose-detection\\posenet\\calculators\\decode_multiple_poses_util.js"}],"generated":{"js":"\"use strict\";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function u(e){try{s(n.next(e))}catch(t){i(t)}}function a(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(u,a)}s((n=n.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError(\"Generator is already executing.\");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(exports,\"__esModule\",{value:!0});var r=require(\"../constants\"),n=require(\"./build_part_with_score_queue\"),o=require(\"./decode_multiple_poses_util\");function i(i,u,a,s,c,l,f,p){return void 0===f&&(f=.5),void 0===p&&(p=20),e(this,void 0,void 0,function(){var e,h,d,b,y,_,v,w,g,m,x,P;return t(this,function(t){switch(t.label){case 0:return[4,o.toTensorBuffers3D([i,u,a,s])];case 1:for(e=t.sent(),h=e[0],d=e[1],b=e[2],y=e[3],_=[],v=n.buildPartWithScoreQueue(f,r.K_LOCAL_MAXIMUM_RADIUS,h),w=p*p;_.length<l&&!v.empty();)g=v.dequeue(),m=o.getImageCoords(g.part,c,d),o.withinNmsRadiusOfCorrespondingPoint(_,w,m,g.part.id)||(x=o.decodePose(g,h,d,c,b,y),P=o.getInstanceScore(_,w,x),_.push({keypoints:x,score:P}));return[2,_]}})})}exports.decodeMultiplePoses=i;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":1442}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":1446}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":1448}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":1456}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":22,"column":0},"generated":{"line":1,"column":1472}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":22,"column":0},"generated":{"line":1,"column":1474}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":22,"column":0},"generated":{"line":1,"column":1482}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":23,"column":0},"generated":{"line":1,"column":1515}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":23,"column":0},"generated":{"line":1,"column":1517}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":23,"column":0},"generated":{"line":1,"column":1525}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":80,"column":0},"generated":{"line":1,"column":1557}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":80,"column":22},"generated":{"line":1,"column":1566}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":81,"column":4},"generated":{"line":1,"column":1568}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":81,"column":32},"generated":{"line":1,"column":1570}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":82,"column":4},"generated":{"line":1,"column":1572}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":82,"column":34},"generated":{"line":1,"column":1574}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":83,"column":4},"generated":{"line":1,"column":1576}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":83,"column":39},"generated":{"line":1,"column":1578}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":4},"generated":{"line":1,"column":1580}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":26},"generated":{"line":1,"column":1582}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":4},"generated":{"line":1,"column":1597}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":4},"generated":{"line":1,"column":1601}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":4},"generated":{"line":1,"column":1605}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":4},"generated":{"line":1,"column":1607}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":26},"generated":{"line":1,"column":1616}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":26},"generated":{"line":1,"column":1620}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":26},"generated":{"line":1,"column":1624}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":84,"column":26},"generated":{"line":1,"column":1626}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1739}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1745}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1746}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":12},"generated":{"line":1,"column":1748}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":12},"generated":{"line":1,"column":1750}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":88,"column":10},"generated":{"line":1,"column":1768}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":88,"column":11},"generated":{"line":1,"column":1769}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":88,"column":26},"generated":{"line":1,"column":1771}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":88,"column":35},"generated":{"line":1,"column":1773}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":88,"column":52},"generated":{"line":1,"column":1775}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":99,"column":2},"generated":{"line":1,"column":1787}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":8},"generated":{"line":1,"column":1791}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1793}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1795}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":9},"generated":{"line":1,"column":1802}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":21},"generated":{"line":1,"column":1804}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":21},"generated":{"line":1,"column":1806}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":23},"generated":{"line":1,"column":1809}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":36},"generated":{"line":1,"column":1811}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":36},"generated":{"line":1,"column":1813}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":38},"generated":{"line":1,"column":1816}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":60},"generated":{"line":1,"column":1818}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":60},"generated":{"line":1,"column":1820}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":62},"generated":{"line":1,"column":1823}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":84},"generated":{"line":1,"column":1825}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":86,"column":84},"generated":{"line":1,"column":1827}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":90,"column":8},"generated":{"line":1,"column":1830}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":90,"column":24},"generated":{"line":1,"column":1832}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":92,"column":8},"generated":{"line":1,"column":1835}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":92,"column":16},"generated":{"line":1,"column":1837}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":92,"column":16},"generated":{"line":1,"column":1839}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":93,"column":6},"generated":{"line":1,"column":1863}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":93,"column":22},"generated":{"line":1,"column":1865}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":93,"column":22},"generated":{"line":1,"column":1867}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":93,"column":46},"generated":{"line":1,"column":1890}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":95,"column":8},"generated":{"line":1,"column":1893}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":95,"column":27},"generated":{"line":1,"column":1895}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":95,"column":39},"generated":{"line":1,"column":1897}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":99,"column":9},"generated":{"line":1,"column":1899}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":99,"column":15},"generated":{"line":1,"column":1901}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":99,"column":24},"generated":{"line":1,"column":1908}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":99,"column":46},"generated":{"line":1,"column":1912}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":99,"column":52},"generated":{"line":1,"column":1914}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":101,"column":10},"generated":{"line":1,"column":1923}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":101,"column":17},"generated":{"line":1,"column":1925}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":101,"column":23},"generated":{"line":1,"column":1927}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":106,"column":10},"generated":{"line":1,"column":1937}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":107,"column":8},"generated":{"line":1,"column":1939}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":107,"column":8},"generated":{"line":1,"column":1941}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":107,"column":23},"generated":{"line":1,"column":1956}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":107,"column":28},"generated":{"line":1,"column":1958}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":107,"column":34},"generated":{"line":1,"column":1963}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":107,"column":48},"generated":{"line":1,"column":1965}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":108,"column":8},"generated":{"line":1,"column":1968}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":108,"column":8},"generated":{"line":1,"column":1970}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":109,"column":12},"generated":{"line":1,"column":2006}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":109,"column":19},"generated":{"line":1,"column":2008}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":109,"column":37},"generated":{"line":1,"column":2010}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":109,"column":54},"generated":{"line":1,"column":2012}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":109,"column":59},"generated":{"line":1,"column":2014}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":109,"column":64},"generated":{"line":1,"column":2019}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":114,"column":10},"generated":{"line":1,"column":2025}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":114,"column":22},"generated":{"line":1,"column":2027}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":114,"column":22},"generated":{"line":1,"column":2029}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":115,"column":8},"generated":{"line":1,"column":2040}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":115,"column":14},"generated":{"line":1,"column":2042}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":115,"column":28},"generated":{"line":1,"column":2044}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":115,"column":43},"generated":{"line":1,"column":2046}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":115,"column":57},"generated":{"line":1,"column":2048}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":116,"column":8},"generated":{"line":1,"column":2050}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":117,"column":10},"generated":{"line":1,"column":2053}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":117,"column":18},"generated":{"line":1,"column":2055}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":117,"column":18},"generated":{"line":1,"column":2057}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":117,"column":35},"generated":{"line":1,"column":2074}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":117,"column":42},"generated":{"line":1,"column":2076}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":117,"column":60},"generated":{"line":1,"column":2078}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":4},"generated":{"line":1,"column":2081}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":10},"generated":{"line":1,"column":2083}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":15},"generated":{"line":1,"column":2088}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":16},"generated":{"line":1,"column":2089}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":25},"generated":{"line":1,"column":2099}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":27},"generated":{"line":1,"column":2101}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":119,"column":32},"generated":{"line":1,"column":2107}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":122,"column":2},"generated":{"line":1,"column":2112}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":122,"column":2},"generated":{"line":1,"column":2118}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":122,"column":2},"generated":{"line":1,"column":2119}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":122,"column":9},"generated":{"line":1,"column":2121}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":80,"column":0},"generated":{"line":1,"column":2129}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":80,"column":0},"generated":{"line":1,"column":2137}},{"source":"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts","name":null,"original":{"line":80,"column":0},"generated":{"line":1,"column":2157}}],"sources":{"../../../../../../../src/posenet/calculators/decode_multiple_poses.ts":"/**\r\n * @license\r\n * Copyright 2021 Google LLC. All Rights Reserved.\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * =============================================================================\r\n */\r\n\r\nimport * as tf from '@tensorflow/tfjs-core';\r\nimport {Pose} from '../../types';\r\nimport {K_LOCAL_MAXIMUM_RADIUS} from '../constants';\r\nimport {PoseNetOutputStride} from '../types';\r\nimport {buildPartWithScoreQueue} from './build_part_with_score_queue';\r\nimport {decodePose, getImageCoords, getInstanceScore, toTensorBuffers3D, withinNmsRadiusOfCorrespondingPoint} from './decode_multiple_poses_util';\r\n\r\n/**\r\n * Detects multiple poses and finds their parts from part scores and\r\n * displacement vectors. It returns up to `maxDetections` object instance\r\n * detections in decreasing root score order. It works as follows: We first\r\n * create a priority queue with local part score maxima above\r\n * `scoreThreshold`, considering all parts at the same time. Then we\r\n * iteratively pull the top  element of the queue (in decreasing score order)\r\n * and treat it as a root candidate for a new object instance. To avoid\r\n * duplicate detections, we reject the root candidate if it is within a disk\r\n * of `nmsRadius` pixels from the corresponding part of a previously detected\r\n * instance, which is a form of part-based non-maximum suppression (NMS). If\r\n * the root candidate passes the NMS check, we start a new object instance\r\n * detection, treating the corresponding part as root and finding the\r\n * positions of the remaining parts by following the displacement vectors\r\n * along the tree-structured part graph. We assign to the newly detected\r\n * instance a score equal to the sum of scores of its parts which have not\r\n * been claimed by a previous instance (i.e., those at least `nmsRadius`\r\n * pixels away from the corresponding part of all previously detected\r\n * instances), divided by the total number of parts `numParts`.\r\n *\r\n * @param heatmapScores 3-D tensor with shape `[height, width, numParts]`.\r\n * The value of heatmapScores[y, x, k]` is the score of placing the `k`-th\r\n * object part at position `(y, x)`.\r\n *\r\n * @param offsets 3-D tensor with shape `[height, width, numParts * 2]`.\r\n * The value of [offsets[y, x, k], offsets[y, x, k + numParts]]` is the\r\n * short range offset vector of the `k`-th  object part at heatmap\r\n * position `(y, x)`.\r\n *\r\n * @param displacementsFwd 3-D tensor of shape\r\n * `[height, width, 2 * num_edges]`, where `num_edges = num_parts - 1` is the\r\n * number of edges (parent-child pairs) in the tree. It contains the forward\r\n * displacements between consecutive part from the root towards the leaves.\r\n *\r\n * @param displacementsBwd 3-D tensor of shape\r\n * `[height, width, 2 * num_edges]`, where `num_edges = num_parts - 1` is the\r\n * number of edges (parent-child pairs) in the tree. It contains the backward\r\n * displacements between consecutive part from the root towards the leaves.\r\n *\r\n * @param outputStride The output stride that was used when feed-forwarding\r\n * through the PoseNet model.  Must be 32, 16, or 8.\r\n *\r\n * @param maxPoseDetections Maximum number of returned instance detections per\r\n * image.\r\n *\r\n * @param scoreThreshold Only return instance detections that have root part\r\n * score greater or equal to this value. Defaults to 0.5.\r\n *\r\n * @param nmsRadius Non-maximum suppression part distance. It needs to be\r\n * strictly positive. Two parts suppress each other if they are less than\r\n * `nmsRadius` pixels away. Defaults to 20.\r\n *\r\n * @return An array of poses and their scores, each containing keypoints and\r\n * the corresponding keypoint scores.\r\n */\r\nexport async function decodeMultiplePoses(\r\n    heatmapScores: tf.Tensor3D, offsets: tf.Tensor3D,\r\n    displacementFwd: tf.Tensor3D, displacementBwd: tf.Tensor3D,\r\n    outputStride: PoseNetOutputStride, maxPoseDetections: number,\r\n    scoreThreshold = 0.5, nmsRadius = 20): Promise<Pose[]> {\r\n  // tslint:disable-next-line: max-line-length\r\n  const [scoresBuffer, offsetsBuffer, displacementsFwdBuffer, displacementsBwdBuffer] =\r\n      await toTensorBuffers3D(\r\n          [heatmapScores, offsets, displacementFwd, displacementBwd]);\r\n\r\n  const poses: Pose[] = [];\r\n\r\n  const queue = buildPartWithScoreQueue(\r\n      scoreThreshold, K_LOCAL_MAXIMUM_RADIUS, scoresBuffer);\r\n\r\n  const squaredNmsRadius = nmsRadius * nmsRadius;\r\n\r\n  // Generate at most maxDetections object instances per image in\r\n  // decreasing root part score order.\r\n  while (poses.length < maxPoseDetections && !queue.empty()) {\r\n    // The top element in the queue is the next root candidate.\r\n    const root = queue.dequeue();\r\n\r\n    // Part-based non-maximum suppression: We reject a root candidate if it\r\n    // is within a disk of `nmsRadius` pixels from the corresponding part of\r\n    // a previously detected instance.\r\n    const rootImageCoords =\r\n        getImageCoords(root.part, outputStride, offsetsBuffer);\r\n    if (withinNmsRadiusOfCorrespondingPoint(\r\n            poses, squaredNmsRadius, rootImageCoords, root.part.id)) {\r\n      continue;\r\n    }\r\n\r\n    // Start a new detection instance at the position of the root.\r\n    const keypoints = decodePose(\r\n        root, scoresBuffer, offsetsBuffer, outputStride, displacementsFwdBuffer,\r\n        displacementsBwdBuffer);\r\n    const score = getInstanceScore(poses, squaredNmsRadius, keypoints);\r\n\r\n    poses.push({keypoints, score});\r\n  }\r\n\r\n  return poses;\r\n}\r\n"},"lineCount":null}},"error":null,"hash":"efdd0ce830fd00415c15249d3e9f50b0","cacheData":{"env":{}}}